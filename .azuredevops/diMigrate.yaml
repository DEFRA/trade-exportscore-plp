trigger: none

parameters:
  - name: MODEL_IDS
    displayName: "Model IDs (comma-separated)"
    type: string
    default: "" # Input format: "model1,model2,model3"

stages:
  - stage: SND_to_DEV
    displayName: "Migration from SND to DEV"
    jobs:
      - template: ./templates/di-migrate-template.yml
        parameters:
          modelIds: ${{ parameters.MODEL_IDS }}
          sourceEndpoint: "https://sndadpinfdi4401.cognitiveservices.azure.com/"
          targetEndpoint: "https://devadpinfdi1401.cognitiveservices.azure.com/"
          azureSubscription: "AZR-ADP-SND4_DEV1"
          poolName: "DEFRA-COMMON-ubuntu2004-SSV3"
          environmentName: "DEV1"

  - stage: DEV_to_TST
    dependsOn: SND_to_DEV
    displayName: "Migration from DEV to TST"
    jobs:
      - template: ./templates/di-migrate-template.yml
        parameters:
          modelIds: ${{ parameters.MODEL_IDS }}
          sourceEndpoint: "https://devadpinfdi1401.cognitiveservices.azure.com/"
          targetEndpoint: "https://tstadpinfdi1401.cognitiveservices.azure.com/"
          azureSubscription: "AZR-ADP-DEV1_TST1"
          poolName: "DEFRA-COMMON-ubuntu2004-SSV3"
          environmentName: "TST1"

  # - stage: TST_to_PRE
  #   dependsOn: DEV_to_TST
  #   displayName: "Migration from TST to PRE"
  #   jobs:
  #     - template: ./templates/di-migrate-template.yml
  #       parameters:
  #         modelIds: ${{ parameters.MODEL_IDS }}
  #         sourceEndpoint: "https://tstadpinfdi1401.cognitiveservices.azure.com/"
  #         targetEndpoint: "https://preadpinfdi1401.cognitiveservices.azure.com/"
  #         azureSubscription: "AZR-ADP-TST1_PRE1"
  #         poolName: "DEFRA-COMMON-ubuntu2004-SSV5"
  #         environmentName: "PRE1"

  # - stage: PRE_to_PRD
  #   dependsOn: TST_to_PRE
  #   displayName: "Migration from PRE to PRD"
  #   jobs:
  #     - template: ./templates/di-migrate-template.yml
  #       parameters:
  #         modelIds: ${{ parameters.MODEL_IDS }}
  #         sourceEndpoint: "https://preadpinfdi1401.cognitiveservices.azure.com/"
  #         targetEndpoint: "https://prdadpinfdi1401.cognitiveservices.azure.com/"
  #         azureSubscription: "AZR-ADP-PRE1_PRD1"
  #         poolName: "DEFRA-COMMON-ubuntu2004-SSV5"
  #         environmentName: "PRD1"
